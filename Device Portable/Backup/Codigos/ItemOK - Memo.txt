var
  ListBoxItem: TListBoxItem;
  HeightItem: Double;
  Text: TText;
  Memo: TMemo;
  MemoColunas: Integer;
  I:Integer;
begin
  {codigo ok
  ListBoxItem := TListBoxItem.Create(lstboxAgenda);
  ListBoxItem.BeginUpdate;
  SetListBoxItemProperty(ListBoxItem);
  ListBoxItem.Text := Descricao;
  SetListBoxItemHeight(ListBoxItem);
  ListBoxItem.EndUpdate;
  lstboxAgenda.AddObject(ListBoxItem);
  }



  ListBoxItem := TListBoxItem.Create(lstboxAgenda);
  SetListBoxItemProperty(ListBoxItem);


  //if not Assigned(Memo) then
    Memo := TMemo.Create(self);

  {Descricao := Wraptext(Descricao, Trunc((lstboxAgenda.Width -
                                          (MargemEsquerda + MargemDireita ))  /9.3));

  }



  Memo.BeginUpdate;
  Memo.Text := EmptyStr;

  //Memo.Parent := ListBoxItem;
  ListBoxItem.Text:=Descricao;
  Memo.Enabled := False;
  Memo.Align := TAlignLayout.alClient;
  Memo.TextSettings.HorzAlign := TTextAlign.Leading;

  Memo.Padding := ListBoxItem.Padding;
  Memo.Margins := ListBoxItem.Margins;

  //Memo.TextSettings.Font.Style :=  [TFontStyle.fsBold];
  Memo.TextSettings.Font.Size :=  12;
  Memo.Text := Descricao;
  Memo.Margins.Right := MargemDireita;
  Memo.TextSettings.WordWrap:=True;


  ListBoxItem.Height:=  (Memo.Lines.Count * 22);

  lstboxAgenda.AddObject(ListBoxItem);
  //Text.Margins.Left := MargemEsquerda;
//  Text.Padding.Left := ;

   Memo.EndUpdate;


  //Linha em Branco
  ListBoxItem := TListBoxItem.Create(lstboxAgenda);
  ListBoxItem.Text:='';
  SetListBoxItemProperty(ListBoxItem);
  ListBoxItem.Height:= 12;
  lstboxAgenda.AddObject(ListBoxItem);